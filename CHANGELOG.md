# 变更日志

## [v2.3] - 2025-12-19

### 新增功能
- ✨ 强化版全月平衡算法 (`enhancedGlobalBalance`)
- ✨ 多轮迭代优化机制（最多 5 轮）
- ✨ 班次类型平衡功能 (`balanceShiftTypes`)
- ✨ 智能交换可行性检查 (`canSwap`)
- ✨ 详细的平衡过程日志输出

### 改进优化
- 🔧 反转排序逻辑：OFF 少的人优先处理（获得更多休假机会）
- 🔧 动态放宽偏好限制：当落后平均值 3 天以上时开放所有班别
- 🔧 扩大平衡处理范围：从 33% 提升到 40%
- 🔧 增加自适应终止条件：标准差 < 1.5 时提前结束

### 性能影响
- ⏱️ 运算时间增加约 20-30%（仍在 60 秒限制内）
- 📊 平衡效果提升：预期标准差从 5-8 天降低到 < 2 天

### 兼容性
- ✅ 完全兼容现有接口
- ✅ 保持所有规则约束
- ✅ 支持所有策略 (A/B/C)

### 文件变更
- 新增: `js/modules/ai/AutoScheduler_v2.3.js` (600 行)
- 备份: `js/modules/ai/AutoScheduler_v2.2_backup.js` (473 行)
- 更新: `js/modules/ai/AutoScheduler.js` (应用 v2.3)
- 新增: `IMPROVEMENTS.md` (详细改进说明)
- 新增: `diagnosis.md` (问题诊断报告)
- 新增: `test_comparison.md` (测试对比文档)

### 代码统计
- 新增代码: 127 行
- 修改代码: 约 50 行
- 总代码量: 600 行 (+26.8%)

## [v2.2] - 之前版本

### 功能
- 基础排班算法
- 简单的全月平衡
- 连续工作天数限制
- 班次间隔规则
